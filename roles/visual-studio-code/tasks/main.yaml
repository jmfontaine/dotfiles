- name: Install Visual Studio Code
  homebrew_cask:
    name: visual-studio-code
    state: present
    install_options: appdir=/Applications

- name: Install/Update Visual Studio Code Extensions
  shell: |
    spawn code --install-extension {{item}}
    expect "> Extension '*' v* is already installed, but a newer version * is available in the marketplace. Would you like to update? Yes(0) | No(1)\n"
    send "1\n"

    exit 0
  with_items: '{{ extensions }}'

- name: Copy Configuration File
  copy:
    src: '{{ role_path }}/files/settings.json'
    dest: ~/Library/Application Support/Code/User/settings.json

- name: Copy Initialization File
  copy:
    src: '{{ role_path }}/files/visual-studio-code_init.zsh'
    dest: ~/.zsh/visual-studio-code_init.zsh
